import{M as e,V as t,a as o,Q as i,E as r,B as n,b as s,I as a,c,T as l,d as h,e as d,L as u,h as p,P as m,S as f,C as g,W as y,A as b,f as v,g as w,G as E,i as x,j as k,k as T,l as j,m as S,n as M,F as B}from"./GLTFLoader-8a8cae8b.js";import"./lodash-a1d2dbc5.js";var A=function(){var e=0,t=document.createElement("div");function o(e){return t.appendChild(e.dom),e}function i(o){for(var i=0;i<t.children.length;i++)t.children[i].style.display=i===o?"block":"none";e=o}t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",(function(o){o.preventDefault(),i(++e%t.children.length)}),!1);var r=(performance||Date).now(),n=r,s=0,a=o(new A.Panel("FPS","#0ff","#002")),c=o(new A.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=o(new A.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:t,addPanel:o,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(c.update(e-r,200),e>=n+1e3&&(a.update(1e3*s/(e-n),100),n=e,s=0,l)){var t=performance.memory;l.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){r=this.end()},domElement:t,setMode:i}};A.Panel=function(e,t,o){var i=1/0,r=0,n=Math.round,s=n(window.devicePixelRatio||1),a=80*s,c=48*s,l=3*s,h=2*s,d=3*s,u=15*s,p=74*s,m=30*s,f=document.createElement("canvas");f.width=a,f.height=c,f.style.cssText="width:80px;height:48px";var g=f.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=o,g.fillRect(0,0,a,c),g.fillStyle=t,g.fillText(e,l,h),g.fillRect(d,u,p,m),g.fillStyle=o,g.globalAlpha=.9,g.fillRect(d,u,p,m),{dom:f,update:function(c,y){i=Math.min(i,c),r=Math.max(r,c),g.fillStyle=o,g.globalAlpha=1,g.fillRect(0,0,a,u),g.fillStyle=t,g.fillText(n(c)+" "+e+" ("+n(i)+"-"+n(r)+")",l,h),g.drawImage(f,d+s,u,p-s,m,d,u,p-s,m),g.fillRect(d+p-s,u,s,m),g.fillStyle=o,g.globalAlpha=.9,g.fillRect(d+p-s,u,s,n((1-c/y)*m))}}};var R=function(r,n){void 0===n&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');var s=this,a=-1,c=0,l=1,h=2,d=3,u=4;this.object=r,this.domElement=n,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:e.ROTATE,MIDDLE:e.ZOOM,RIGHT:e.PAN},this.target=new t;var p=1e-6,m=new t,f=1,g=a,y=a,b=new t,v=new o,w=new o,E=new t,x=0,k=new o,T=new o,j=0,S=0,M=new o,B=new o;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var A={type:"change"},R={type:"start"},D={type:"end"};this.handleResize=function(){var e=s.domElement.getBoundingClientRect(),t=s.domElement.ownerDocument.documentElement;s.screen.left=e.left+window.pageXOffset-t.clientLeft,s.screen.top=e.top+window.pageYOffset-t.clientTop,s.screen.width=e.width,s.screen.height=e.height};var L,z,P,C,X,Y,G,H,O,U,I,V=(L=new o,function(e,t){return L.set((e-s.screen.left)/s.screen.width,(t-s.screen.top)/s.screen.height),L}),q=function(){var e=new o;return function(t,o){return e.set((t-.5*s.screen.width-s.screen.left)/(.5*s.screen.width),(s.screen.height+2*(s.screen.top-o))/s.screen.width),e}}();function F(e){if(!1!==s.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(e.preventDefault(),e.stopPropagation(),g===a)switch(e.button){case s.mouseButtons.LEFT:g=c;break;case s.mouseButtons.MIDDLE:g=l;break;case s.mouseButtons.RIGHT:g=h;break;default:g=a}var t=y!==a?y:g;t!==c||s.noRotate?t!==l||s.noZoom?t!==h||s.noPan||(M.copy(V(e.pageX,e.pageY)),B.copy(M)):(k.copy(V(e.pageX,e.pageY)),T.copy(k)):(w.copy(q(e.pageX,e.pageY)),v.copy(w));s.domElement.ownerDocument.addEventListener("pointermove",W,!1),s.domElement.ownerDocument.addEventListener("pointerup",Z,!1),s.dispatchEvent(R)}(e)}}function W(e){if(!1!==s.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===s.enabled)return;e.preventDefault(),e.stopPropagation();var t=y!==a?y:g;t!==c||s.noRotate?t!==l||s.noZoom?t!==h||s.noPan||B.copy(V(e.pageX,e.pageY)):T.copy(V(e.pageX,e.pageY)):(v.copy(w),w.copy(q(e.pageX,e.pageY)))}(e)}}function Z(e){if(!1!==s.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===s.enabled)return;e.preventDefault(),e.stopPropagation(),g=a,s.domElement.ownerDocument.removeEventListener("pointermove",W),s.domElement.ownerDocument.removeEventListener("pointerup",Z),s.dispatchEvent(D)}(e)}}function _(e){!1!==s.enabled&&(window.removeEventListener("keydown",_),y===a&&(e.keyCode!==s.keys[c]||s.noRotate?e.keyCode!==s.keys[l]||s.noZoom?e.keyCode!==s.keys[h]||s.noPan||(y=h):y=l:y=c))}function N(){!1!==s.enabled&&(y=a,window.addEventListener("keydown",_,!1))}function $(e){if(!1!==s.enabled&&!0!==s.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:k.y-=.025*e.deltaY;break;case 1:k.y-=.01*e.deltaY;break;default:k.y-=25e-5*e.deltaY}s.dispatchEvent(R),s.dispatchEvent(D)}}function Q(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:g=d,w.copy(q(e.touches[0].pageX,e.touches[0].pageY)),v.copy(w);break;default:g=u;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;S=j=Math.sqrt(t*t+o*o);var i=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;M.copy(V(i,r)),B.copy(M)}s.dispatchEvent(R)}}function J(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:v.copy(w),w.copy(q(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;S=Math.sqrt(t*t+o*o);var i=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;B.copy(V(i,r))}}function K(e){if(!1!==s.enabled){switch(e.touches.length){case 0:g=a;break;case 1:g=d,w.copy(q(e.touches[0].pageX,e.touches[0].pageY)),v.copy(w)}s.dispatchEvent(D)}}function ee(e){!1!==s.enabled&&e.preventDefault()}this.rotateCamera=(P=new t,C=new i,X=new t,Y=new t,G=new t,H=new t,function(){H.set(w.x-v.x,w.y-v.y,0),(z=H.length())?(b.copy(s.object.position).sub(s.target),X.copy(b).normalize(),Y.copy(s.object.up).normalize(),G.crossVectors(Y,X).normalize(),Y.setLength(w.y-v.y),G.setLength(w.x-v.x),H.copy(Y.add(G)),P.crossVectors(H,b).normalize(),z*=s.rotateSpeed,C.setFromAxisAngle(P,z),b.applyQuaternion(C),s.object.up.applyQuaternion(C),E.copy(P),x=z):!s.staticMoving&&x&&(x*=Math.sqrt(1-s.dynamicDampingFactor),b.copy(s.object.position).sub(s.target),C.setFromAxisAngle(E,x),b.applyQuaternion(C),s.object.up.applyQuaternion(C)),v.copy(w)}),this.zoomCamera=function(){var e;g===u?(e=j/S,j=S,s.object.isPerspectiveCamera?b.multiplyScalar(e):s.object.isOrthographicCamera?(s.object.zoom*=e,s.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!==(e=1+(T.y-k.y)*s.zoomSpeed)&&e>0&&(s.object.isPerspectiveCamera?b.multiplyScalar(e):s.object.isOrthographicCamera?(s.object.zoom/=e,s.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),s.staticMoving?k.copy(T):k.y+=(T.y-k.y)*this.dynamicDampingFactor)},this.panCamera=(O=new o,U=new t,I=new t,function(){if(O.copy(B).sub(M),O.lengthSq()){if(s.object.isOrthographicCamera){var e=(s.object.right-s.object.left)/s.object.zoom/s.domElement.clientWidth,t=(s.object.top-s.object.bottom)/s.object.zoom/s.domElement.clientWidth;O.x*=e,O.y*=t}O.multiplyScalar(b.length()*s.panSpeed),I.copy(b).cross(s.object.up).setLength(O.x),I.add(U.copy(s.object.up).setLength(O.y)),s.object.position.add(I),s.target.add(I),s.staticMoving?M.copy(B):M.add(O.subVectors(B,M).multiplyScalar(s.dynamicDampingFactor))}}),this.checkDistances=function(){s.noZoom&&s.noPan||(b.lengthSq()>s.maxDistance*s.maxDistance&&(s.object.position.addVectors(s.target,b.setLength(s.maxDistance)),k.copy(T)),b.lengthSq()<s.minDistance*s.minDistance&&(s.object.position.addVectors(s.target,b.setLength(s.minDistance)),k.copy(T)))},this.update=function(){b.subVectors(s.object.position,s.target),s.noRotate||s.rotateCamera(),s.noZoom||s.zoomCamera(),s.noPan||s.panCamera(),s.object.position.addVectors(s.target,b),s.object.isPerspectiveCamera?(s.checkDistances(),s.object.lookAt(s.target),m.distanceToSquared(s.object.position)>p&&(s.dispatchEvent(A),m.copy(s.object.position))):s.object.isOrthographicCamera?(s.object.lookAt(s.target),(m.distanceToSquared(s.object.position)>p||f!==s.object.zoom)&&(s.dispatchEvent(A),m.copy(s.object.position),f=s.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){g=a,y=a,s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.up.copy(s.up0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),b.subVectors(s.object.position,s.target),s.object.lookAt(s.target),s.dispatchEvent(A),m.copy(s.object.position),f=s.object.zoom},this.dispose=function(){s.domElement.removeEventListener("contextmenu",ee,!1),s.domElement.removeEventListener("pointerdown",F,!1),s.domElement.removeEventListener("wheel",$,!1),s.domElement.removeEventListener("touchstart",Q,!1),s.domElement.removeEventListener("touchend",K,!1),s.domElement.removeEventListener("touchmove",J,!1),s.domElement.ownerDocument.removeEventListener("pointermove",W,!1),s.domElement.ownerDocument.removeEventListener("pointerup",Z,!1),window.removeEventListener("keydown",_,!1),window.removeEventListener("keyup",N,!1)},this.domElement.addEventListener("contextmenu",ee,!1),this.domElement.addEventListener("pointerdown",F,!1),this.domElement.addEventListener("wheel",$,!1),this.domElement.addEventListener("touchstart",Q,!1),this.domElement.addEventListener("touchend",K,!1),this.domElement.addEventListener("touchmove",J,!1),this.domElement.ownerDocument.addEventListener("pointermove",W,!1),this.domElement.ownerDocument.addEventListener("pointerup",Z,!1),window.addEventListener("keydown",_,!1),window.addEventListener("keyup",N,!1),this.handleResize(),this.update()};(R.prototype=Object.create(r.prototype)).constructor=R;var D={computeTangents:function(e){var i=e.index,r=e.attributes;if(null!==i&&void 0!==r.position&&void 0!==r.normal&&void 0!==r.uv){var s=i.array,a=r.position.array,c=r.normal.array,l=r.uv.array,h=a.length/3;void 0===r.tangent&&e.setAttribute("tangent",new n(new Float32Array(4*h),4));for(var d=r.tangent.array,u=[],p=[],m=0;m<h;m++)u[m]=new t,p[m]=new t;var f=new t,g=new t,y=new t,b=new o,v=new o,w=new o,E=new t,x=new t,k=e.groups;0===k.length&&(k=[{start:0,count:s.length}]);m=0;for(var T=k.length;m<T;++m)for(var j=C=(P=k[m]).start,S=C+P.count;j<S;j+=3)X(s[j+0],s[j+1],s[j+2]);var M,B,A,R=new t,D=new t,L=new t,z=new t;for(m=0,T=k.length;m<T;++m){var P,C;for(j=C=(P=k[m]).start,S=C+P.count;j<S;j+=3)Y(s[j+0]),Y(s[j+1]),Y(s[j+2])}}else console.error("THREE.BufferGeometryUtils: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function X(e,t,o){f.fromArray(a,3*e),g.fromArray(a,3*t),y.fromArray(a,3*o),b.fromArray(l,2*e),v.fromArray(l,2*t),w.fromArray(l,2*o),g.sub(f),y.sub(f),v.sub(b),w.sub(b);var i=1/(v.x*w.y-w.x*v.y);isFinite(i)&&(E.copy(g).multiplyScalar(w.y).addScaledVector(y,-v.y).multiplyScalar(i),x.copy(y).multiplyScalar(v.x).addScaledVector(g,-w.x).multiplyScalar(i),u[e].add(E),u[t].add(E),u[o].add(E),p[e].add(x),p[t].add(x),p[o].add(x))}function Y(e){L.fromArray(c,3*e),z.copy(L),B=u[e],R.copy(B),R.sub(L.multiplyScalar(L.dot(B))).normalize(),D.crossVectors(z,B),A=D.dot(p[e]),M=A<0?-1:1,d[4*e]=R.x,d[4*e+1]=R.y,d[4*e+2]=R.z,d[4*e+3]=M}},mergeBufferGeometries:function(e,t){for(var o=null!==e[0].index,i=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),n={},a={},c=e[0].morphTargetsRelative,l=new s,h=0,d=0;d<e.length;++d){var u=e[d],p=0;if(o!==(null!==u.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var m in u.attributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;void 0===n[m]&&(n[m]=[]),n[m].push(u.attributes[m]),p++}if(p!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(c!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var m in u.morphAttributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[m]&&(a[m]=[]),a[m].push(u.morphAttributes[m])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(u.userData),t){var f;if(o)f=u.index.count;else{if(void 0===u.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;f=u.attributes.position.count}l.addGroup(h,f,d),h+=f}}if(o){var g=0,y=[];for(d=0;d<e.length;++d){for(var b=e[d].index,v=0;v<b.count;++v)y.push(b.getX(v)+g);g+=e[d].attributes.position.count}l.setIndex(y)}for(var m in n){var w=this.mergeBufferAttributes(n[m]);if(!w)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+m+" attribute."),null;l.setAttribute(m,w)}for(var m in a){var E=a[m][0].length;if(0===E)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[m]=[];for(d=0;d<E;++d){var x=[];for(v=0;v<a[m].length;++v)x.push(a[m][v][d]);var k=this.mergeBufferAttributes(x);if(!k)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+m+" morphAttribute."),null;l.morphAttributes[m].push(k)}}return l},mergeBufferAttributes:function(e){for(var t,o,i,r=0,s=0;s<e.length;++s){var a=e[s];if(a.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===o&&(o=a.itemSize),o!==a.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=a.normalized),i!==a.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=a.array.length}var c=new t(r),l=0;for(s=0;s<e.length;++s)c.set(e[s].array,l),l+=e[s].array.length;return new n(c,o,i)},interleaveAttributes:function(e){for(var t,o=0,i=0,r=0,n=e.length;r<n;++r){var s=e[r];if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;o+=s.array.length,i+=s.itemSize}var l=new a(new t(o),i),h=0,d=[],u=["getX","getY","getZ","getW"],p=["setX","setY","setZ","setW"],m=0;for(n=e.length;m<n;m++){var f=(s=e[m]).itemSize,g=s.count,y=new c(l,f,h,s.normalized);d.push(y),h+=f;for(var b=0;b<g;b++)for(var v=0;v<f;v++)y[p[v]](b,s[u[v]](b))}return d},estimateBytesUsed:function(e){var t=0;for(var o in e.attributes){var i=e.getAttribute(o);t+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}var r=e.getIndex();return t+=r?r.count*r.itemSize*r.array.BYTES_PER_ELEMENT:0},mergeVertices:function(e,t=1e-4){t=Math.max(t,Number.EPSILON);for(var o={},i=e.getIndex(),r=e.getAttribute("position"),s=i?i.count:r.count,a=0,c=Object.keys(e.attributes),l={},h={},d=[],u=["getX","getY","getZ","getW"],p=0,m=c.length;p<m;p++){l[w=c[p]]=[],(T=e.morphAttributes[w])&&(h[w]=new Array(T.length).fill().map((()=>[])))}var f=Math.log10(1/t),g=Math.pow(10,f);for(p=0;p<s;p++){var y=i?i.getX(p):p,b="",v=0;for(m=c.length;v<m;v++)for(var w=c[v],E=(k=e.getAttribute(w)).itemSize,x=0;x<E;x++)b+=~~(k[u[x]](y)*g)+",";if(b in o)d.push(o[b]);else{for(v=0,m=c.length;v<m;v++){w=c[v];var k=e.getAttribute(w),T=e.morphAttributes[w],j=(E=k.itemSize,l[w]),S=h[w];for(x=0;x<E;x++){var M=u[x];if(j.push(k[M](y)),T)for(var B=0,A=T.length;B<A;B++)S[B].push(T[B][M](y))}}o[b]=a,d.push(a),a++}}const R=e.clone();for(p=0,m=c.length;p<m;p++){w=c[p];var D=e.getAttribute(w),L=new D.array.constructor(l[w]);k=new n(L,D.itemSize,D.normalized);if(R.setAttribute(w,k),w in h)for(v=0;v<h[w].length;v++){var z=e.morphAttributes[w][v],P=(L=new z.array.constructor(h[w][v]),new n(L,z.itemSize,z.normalized));R.morphAttributes[w][v]=P}}return R.setIndex(d),R},toTrianglesDrawMode:function(e,t){if(t===l)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===h||t===d){var o=e.getIndex();if(null===o){var i=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var n=0;n<r.count;n++)i.push(n);e.setIndex(i),o=e.getIndex()}var s=o.count-2,a=[];if(t===h)for(n=1;n<=s;n++)a.push(o.getX(0)),a.push(o.getX(n)),a.push(o.getX(n+1));else for(n=0;n<s;n++)n%2==0?(a.push(o.getX(n)),a.push(o.getX(n+1)),a.push(o.getX(n+2))):(a.push(o.getX(n+2)),a.push(o.getX(n+1)),a.push(o.getX(n)));a.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(a),c.clearGroups(),c}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}};window.customElements.define("ray-cast",class extends u{static get properties(){return{container:{type:Object},stats:{type:Object},camera:{type:Object},controls:{type:Object},scene:{type:Object},renderer:{type:Object},pickingTexture:{type:Object},pickingScene:{type:Object},highlightShape:{type:Object},mouse:{type:Object},mousePosX:{type:Object},mousePosY:{type:Object},infoVisible:{type:String},offset:{type:Object},pickingData:{type:Object},cursorType:{type:String},canClick:{type:Boolean},link:{type:String},duplicated:{type:Boolean},que:{type:Object},work:{type:Object},queBig:{type:Object},workBig:{type:Object},files:{type:Array}}}constructor(){super(),this.mouse=new o,this.mousePosX="0px",this.mousePosY="0px",this.beganTouching=!1,this.offset=new t(1,1,1),this.duplicated=!1,this.pickingData=[],this.cursorType="grab",this.canClick=!1,this.link="",this.addEventListener("click",this.clickLink),this.addEventListener("touchstart",this.touchStart),this.addEventListener("touchmove",this.touchMove),this.addEventListener("touchend",this.touchEnd)}render(){return p`<style>:host{cursor:${this.cursorType}}.followMouse{top:${this.mousePosY};left:${this.mousePosX};color:#fff;font-size:20px;visibility:${this.infoVisible};position:absolute;z-index:10}#crosshair{top:${this.YCenter};left:${this.XCenter};position:absolute;visibility:hidden;width:0;height:0;z-index:100}#upSpoke{background:#fff;height:10px;width:2px;transform:translateY(-3px)}#sideSpoke{background:#fff;height:2px;width:10px;transform:translate(-4px,-9px)}@media (hover:none){#crosshair{visibility:visible}}</style><div id="container"></div><div id="infoText" class="followMouse"></div><div id="crosshair"><div id="upSpoke"></div><div id="sideSpoke"></div></div>`}async firstUpdated(){await new Promise((e=>setTimeout(e,0))),this.init(),this.animate()}init(){this.container=this.shadowRoot.getElementById("container"),this.camera=new m(70,window.innerWidth/window.innerHeight,1,1e4),this.camera.position.z=1e3,this.XCenter=window.innerWidth/2+"px",this.YCenter=window.innerHeight/2+"px",this.mousePosX=this.XCenter,this.mousePosY=this.YCenter,this.mouse.x=this.XCenter,this.mouse.y=this.YCenter,this.scene=new f,this.scene.background=new g(4342338),this.pickingScene=new f,this.pickingTexture=new y(1,1),this.scene.add(new b(5592405));const e=new v(16777215,1.5);e.position.set(0,500,2e4),this.scene.add(e),this.files=["que","work","github","math"],this.work=this.loadModel("/src/assets/models/gltf/radcam.glb"),this.workBig=this.loadModel("/src/assets/models/gltf/radcamBig.glb"),this.que=this.loadModel("/src/assets/models/gltf/questionmark.glb"),this.queBig=this.loadModel("/src/assets/models/gltf/questionmarkBig.glb"),this.github=this.loadModel("/src/assets/models/gltf/github.glb"),this.githubBig=this.loadModel("/src/assets/models/gltf/githubBig.glb"),this.math=this.loadModel("/src/assets/models/gltf/math.glb"),this.mathBig=this.loadModel("/src/assets/models/gltf/mathBig.glb"),this.renderer=new w({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.container.appendChild(this.renderer.domElement),this.controls=new R(this.camera,this.renderer.domElement),this.controls.rotateSpeed=-1,this.controls.zoomSpeed=1.2,this.controls.panSpeed=-.8,this.controls.noZoom=!1,this.controls.noPan=!1,this.controls.staticMoving=!0,this.controls.dynamicDampingFactor=.3,this.stats=new A,this.renderer.domElement.addEventListener("mousemove",this.onMouseMove.bind(this)),window.addEventListener("resize",this.onWindowResize.bind(this),!1)}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight),this.XCenter=window.innerWidth/2+"px",this.YCenter=window.innerHeight/2+"px",this.mousePosX=this.XCenter,this.mousePosY=this.YCenter}onMouseMove(e){this.mouse.x=e.clientX,this.mouse.y=e.clientY,this.mousePosX=this.mouse.x+15+"px",this.mousePosY=this.mouse.y+15+"px"}loadModel(e){var t=new E,o=new x;return t.load(e,(function(e){e.scene.traverse((function(e){})),o.add(e.scene)})),o}animate(){window.requestAnimationFrame((()=>this.animate())),0==this.duplicated&&this.duplicate(),1==this.duplicated&&(this.threeRender(),this.stats.update())}threeRender(){this.controls.update(),this.pick(),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)}duplicate(){var e=this.files;const o={},r={},n=new k,s=new i,a=new g,c=new T({vertexColors:!0}),l=new j({color:16777215,flatShading:!0,vertexColors:!0,shininess:0});var h=this.cloneFiles(e);if(null!=h){for(var d in e){var u=e[d];o[u]=[],r[u]=[]}for(let i=1;i<51;i++){var p=h[Math.floor(Math.random()*e.length)],m=p.data.clone();const c=new t;c.x=1e4*Math.random()-5e3,c.y=6e3*Math.random()-3e3,c.z=8e3*Math.random()-4e3;const l=new S;l.x=2*Math.random()*Math.PI,l.y=2*Math.random()*Math.PI,l.z=2*Math.random()*Math.PI;const d=new t(50,50,50);s.setFromEuler(l),n.compose(c,s,d),m.applyMatrix4(n),this.applyVertexColors(m,a.setHex(394758)),o[p.type].push(m),m=m.clone(),this.applyVertexColors(m,a.setHex(i)),r[p.type].push(m),this.pickingData[i]={position:c,rotation:l,scale:d,type:p.type}}for(var d in this.highlightShape={},e){var f=e[d];if("work"==f)var y=13199411;if("github"==f)y=3608130;if("que"==f)y=16728418;if("math"==f)y=12575679;this.highlightShape[e[d]]=new M(h[d].bigData,new j({color:y,flatShading:!1,shininess:150})),this.scene.add(this.highlightShape[e[d]]),this.objects=new M(D.mergeBufferGeometries(o[e[d]]),l),this.scene.add(this.objects),this.pickingScene.add(new M(D.mergeBufferGeometries(r[e[d]]),c))}this.duplicated=!0}}cloneFiles(e){for(var t in e){var o=_.get(this,[e[t],"children",0,"children"],null),i=_.get(this,[e[t]+"Big","children",0,"children"],null);if(null==o||null==i)return null}var r=[];for(var t in e){var n={},s=e[t],a=_.get(this,[s,"children",0,"children"]);if(a.find((e=>"Mesh"==e.type)))n.data=a.find((e=>"Mesh"==e.type)).geometry;else{var c=a.find((e=>"Group"==e.type));if(c){for(var l=[],h=0;h<c.children.length;h++){var d=c.children[h].geometry;l.push(d)}var u=D.mergeBufferGeometries(l);n.data=u}}var p=_.get(this,[s+"Big","children",0,"children"]);if(p.find((e=>"Mesh"==e.type)))n.bigData=p.find((e=>"Mesh"==e.type)).geometry;else{var m=p.find((e=>"Group"==e.type));if(m){for(l=[],h=0;h<m.children.length;h++){d=m.children[h].geometry;l.push(d)}u=D.mergeBufferGeometries(l);n.bigData=u}}n.type=s,r.push(n)}return r}pick(){this.camera.setViewOffset(this.renderer.domElement.width,this.renderer.domElement.height,this.mouse.x*window.devicePixelRatio|0,this.mouse.y*window.devicePixelRatio|0,1,1),this.renderer.setRenderTarget(this.pickingTexture),this.renderer.render(this.pickingScene,this.camera),this.camera.clearViewOffset();const e=new Uint8Array(4);this.renderer.readRenderTargetPixels(this.pickingTexture,0,0,1,1,e);const t=e[0]<<16|e[1]<<8|e[2],o=this.pickingData[t];var i=this.shadowRoot.getElementById("infoText");if(t>0?(this.cursorType="pointer",this.infoVisible="visible","work"==o.type&&(this.link="src/work.html",i.innerHTML="work portfolio"),"github"==o.type&&(this.link="https://github.com/herdofsheep",i.innerHTML="github"),"que"==o.type&&(this.link="src/what.html",i.innerHTML="what's this?"),"math"==o.type&&(this.link="src/art.html",i.innerHTML="art portfolio"),this.canClick=!0):this.infoVisible="hidden",o&&t>0)o.position&&o.rotation&&o.scale&&o.type&&(this.highlightShape[o.type].position.copy(o.position),this.highlightShape[o.type].rotation.copy(o.rotation),this.highlightShape[o.type].scale.copy(o.scale).add(this.offset),this.highlightShape[o.type].visible=!0);else{for(var r in this.files)this.highlightShape[this.files[r]].visible=!1;this.cursorType="grab",this.canClick=!1}}clickLink(){this.canClick&&(window.location.href=this.link)}touchStart(){this.canClick&&(this.beganTouching=!0)}touchMove(){this.beganTouching=!1}touchEnd(){this.canClick&&this.beganTouching&&(window.location.href=this.link)}applyVertexColors(e,t){const o=e.attributes.position,i=[];for(let e=0;e<o.count;e++)i.push(t.r,t.g,t.b);e.setAttribute("color",new B(i,3))}});
